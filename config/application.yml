# 통합 애플리케이션 설정
# 환경변수로 오버라이드 가능: ${VARIABLE_NAME:-default_value}

# 기본 설정
defaults: &defaults
  app:
    name: blacklist-management
    version: "3.0.0"
    timezone: Asia/Seoul
  
  server:
    host: 0.0.0.0
    dev_port: 8541
    prod_port: 2541
    staging_port: 2542
  
  database:
    sqlite_path: instance/blacklist.db
    redis_db: 0
  
  cache:
    ttl_default: 300
    ttl_long: 3600
    ttl_short: 60
  
  rate_limits:
    public: "1000/hour"
    authenticated: "5000/hour"
    admin: "10000/hour"
  
  collection:
    enabled: true
    interval_hours: 6
    max_retries: 3
  
  # 배포 설정
  deployment:
    registry:
      url: "${DOCKER_REGISTRY:-registry.jclee.me}"
      username: "${REGISTRY_USERNAME:-qws941}"
      password: "${REGISTRY_PASSWORD}"
    
    watchtower:
      poll_interval: 30
      cleanup: true
      include_stopped: true
      include_restarting: true
      label_enable: true
      rolling_restart: true
    
    cicd:
      timeout: 600
      coverage: true
      security_scan: true
      platforms: linux/amd64
      cache: true

# 환경별 설정
development:
  <<: *defaults
  environment: development
  debug: true
  
  server:
    <<: *defaults.server
    port: 8541
  
  deployment:
    host: localhost
    registry: localhost:5000
    method: local
  
  external_services:
    regtech:
      base_url: https://regtech.fsec.or.kr
      username: test_user
      password: test_pass
    secudium:
      base_url: https://secudium.skinfosec.co.kr
      username: test_user
      password: test_pass

staging:
  <<: *defaults
  environment: staging
  debug: false
  
  server:
    <<: *defaults.server
    port: 2542
  
  deployment:
    host: "${DEPLOY_HOST:-registry.jclee.me}"
    ssh_port: "${DEPLOY_SSH_PORT:-1112}"
    user: "${DEPLOY_USER:-docker}"
    method: watchtower
  
  external_services:
    regtech:
      base_url: https://regtech.fsec.or.kr
      username: "${REGTECH_USERNAME}"
      password: "${REGTECH_PASSWORD}"
    secudium:
      base_url: https://secudium.skinfosec.co.kr
      username: "${SECUDIUM_USERNAME}"
      password: "${SECUDIUM_PASSWORD}"

production:
  <<: *defaults
  environment: production
  debug: false
  
  server:
    <<: *defaults.server
    port: 2541
  
  deployment:
    host: "${DEPLOY_HOST:-registry.jclee.me}"
    ssh_port: "${DEPLOY_SSH_PORT:-1112}"
    user: "${DEPLOY_USER:-docker}"
    method: watchtower
  
  external_services:
    regtech:
      base_url: https://regtech.fsec.or.kr
      username: "${REGTECH_USERNAME}"
      password: "${REGTECH_PASSWORD}"
    secudium:
      base_url: https://secudium.skinfosec.co.kr
      username: "${SECUDIUM_USERNAME}"
      password: "${SECUDIUM_PASSWORD}"