# Blacklist 프로젝트 인프라 현황 문서
# 생성일: 2025-08-17
# 작성자: Claude Code

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: deployment-status
  namespace: blacklist
data:
  deployment_type: "docker-compose"
  production_registry: "registry.jclee.me/blacklist:latest"
  
  # 현재 운영 환경
  current_environment: |
    - 배포 방식: Docker Compose (docker-compose.yml)
    - 컨테이너: 2개 (blacklist, redis)
    - 외부 포트: 32542 → 내부 포트: 2542
    - Redis: 7-alpine (256MB 메모리 제한)
    - 네트워크: blacklist-network (bridge)
    - 볼륨: ./data (SQLite), ./logs (로그), redis_data (Redis)
  
  # 서비스 상태 (2025-08-17 17:00 기준)
  service_status: |
    - blacklist 컨테이너: Running (healthy) - 3시간+ 가동
    - redis 컨테이너: Running (healthy)
    - 헬스체크: 모든 컴포넌트 정상
    - 데이터베이스: SQLite (스키마 v2.0.0)
  
  # 환경 변수 설정
  environment_config: |
    FLASK_ENV: production
    DATABASE_URL: sqlite:////app/instance/blacklist.db
    REDIS_URL: redis://redis:6379/0
    COLLECTION_ENABLED: true (Docker)
    FORCE_DISABLE_COLLECTION: false (Docker)
    MAX_AUTH_ATTEMPTS: 5
    BLOCK_DURATION_HOURS: 1
  
  # Kubernetes 준비 상태
  k8s_readiness: |
    - Helm Chart: 준비 완료 (chart/blacklist/)
    - ArgoCD App: 설정 완료 (argocd/blacklist-app.yaml)
    - Namespace: blacklist
    - Service Type: ClusterIP + NodePort (32542)
    - Ingress: Traefik (blacklist.jclee.me)
    
  # 수정 완료 사항 (2025-08-17)
  completed_fixes: |
    ✅ ArgoCD 중복 애플리케이션 제거 (application.yaml 삭제)
    ✅ Secret 이름 통일 (blacklist-secrets → blacklist-credentials)
    ✅ imagePullSecrets 통일 (registry-secret → registry-credentials)
    ✅ Helm Chart 경로 확인 (chart/blacklist 사용)
    ✅ Redis 설정 일관성 확보
    
  # 향후 마이그레이션 계획
  migration_plan: |
    1단계: 현재 Docker Compose 운영 유지
    2단계: Kubernetes 클러스터 준비 시 Helm 배포
    3단계: ArgoCD GitOps 파이프라인 활성화
    4단계: 점진적 트래픽 전환
    
  # 권장 사항
  recommendations: |
    - REGTECH/SECUDIUM 자격증명 실제 값 설정 필요
    - 테스트 커버리지 20% → 35% 향상 필요
    - PostgreSQL 마이그레이션 고려 (프로덕션)
    - 모니터링 강화 (Prometheus + Grafana)