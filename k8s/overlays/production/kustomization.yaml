apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: blacklist

resources:
- ../../base
- ingress.yaml

patches:
- path: deployment-patch.yaml
  target:
    kind: Deployment
    name: blacklist
- path: service-patch.yaml
  target:
    kind: Service
    name: blacklist

images:
- name: blacklist
  newName: registry.jclee.me/blacklist
  newTag: 1.0.12

configMapGenerator:
- literals:
  - NODE_ENV=production
  - LOG_LEVEL=info
  - FLASK_ENV=production
  - ENABLE_METRICS=true
  - REDIS_URL=
  - DATABASE_URL=sqlite:////app/data/blacklist.db
  - PORT=2541
  name: blacklist-config
