apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: blacklist-staging

resources:
- ../../base
- ingress.yaml

namePrefix: staging-

commonLabels:
  environment: staging
  tier: backend

commonAnnotations:
  environment: staging

patchesStrategicMerge:
- deployment-patch.yaml
- service-patch.yaml

configMapGenerator:
- behavior: merge
  literals:
  - LOG_LEVEL=info
  - FLASK_ENV=staging
  - ENABLE_METRICS=true
  - COLLECTION_ENABLED=true
  - REDIS_URL=redis://redis-staging:6379/0
  name: blacklist-config

secretGenerator:
- behavior: merge
  files:
  - secrets.env
  name: blacklist-secrets

images:
- name: blacklist
  newName: registry.jclee.me/blacklist
  newTag: 1.0.10

replicas:
- count: 2
  name: blacklist
