#!/bin/bash
# Watchtower ì„¤ì • ìˆ˜ì • ìŠ¤í¬ë¦½íŠ¸

echo "ğŸ”§ Watchtower ì„¤ì • ìˆ˜ì •..."
echo ""
echo "ìš´ì˜ ì„œë²„ì—ì„œ ì‹¤í–‰í•  ëª…ë ¹:"
echo ""
echo "# 1. í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸"
echo "docker ps | grep blacklist"
echo ""
echo "# 2. í˜„ì¬ ì´ë¯¸ì§€ í™•ì¸"
echo "docker images | grep blacklist"
echo ""
echo "# 3. Watchtower ë¡œê·¸ í™•ì¸"
echo "docker logs watchtower --tail 50 | grep -E '(blacklist|error|Error)'"
echo ""
echo "# 4. ì˜¬ë°”ë¥¸ ì´ë¯¸ì§€ë¡œ ì»¨í…Œì´ë„ˆ ì¬ìƒì„±"
echo "docker stop blacklist-app"
echo "docker rm blacklist-app"
echo ""
echo "docker run -d \\"
echo "  --name blacklist-app \\"
echo "  --restart unless-stopped \\"
echo "  --network blacklist_blacklist-network \\"
echo "  -p 2541:2541 \\"
echo "  -v /opt/blacklist/instance:/app/instance \\"
echo "  -v /opt/blacklist/data:/app/data \\"
echo "  -v /opt/blacklist/logs:/app/logs \\"
echo "  -e FLASK_ENV=production \\"
echo "  -e PORT=2541 \\"
echo "  -e REDIS_URL=redis://blacklist-redis:6379/0 \\"
echo "  -e REGTECH_USERNAME=nextrade \\"
echo "  -e REGTECH_PASSWORD='Sprtmxm1@3' \\"
echo "  -e SECUDIUM_USERNAME=nextrade \\"
echo "  -e SECUDIUM_PASSWORD='Sprtmxm1@3' \\"
echo "  --label 'com.centurylinklabs.watchtower.enable=true' \\"
echo "  192.168.50.215:1234/blacklist:latest"
echo ""
echo "# 5. Watchtower ì¬ì‹œì‘ (ì´ë¯¸ì§€ ì£¼ì†Œ ì¸ì‹í•˜ë„ë¡)"
echo "docker restart watchtower"
echo ""
echo "# 6. ìˆ˜ë™ìœ¼ë¡œ Watchtower ì‹¤í–‰"
echo "docker run --rm \\"
echo "  -v /var/run/docker.sock:/var/run/docker.sock \\"
echo "  containrrr/watchtower \\"
echo "  --run-once \\"
echo "  blacklist-app"