#!/bin/bash
# ìš´ì˜ ì„œë²„ë¥¼ ë‹¨ì¼ ì»¨í…Œì´ë„ˆë¡œ ì „í™˜í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸

echo "ğŸ”„ ìš´ì˜ ì„œë²„ ë‹¨ì¼ ì»¨í…Œì´ë„ˆ ì „í™˜ ê°€ì´ë“œ"
echo "========================================"
echo ""
echo "í˜„ì¬ ìƒíƒœ: blacklist-app + blacklist-redis (2ê°œ ì»¨í…Œì´ë„ˆ)"
echo "ëª©í‘œ ìƒíƒœ: blacklist (1ê°œ ì»¨í…Œì´ë„ˆ, ë©”ëª¨ë¦¬ ìºì‹œ)"
echo ""
echo "ìš´ì˜ ì„œë²„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”:"
echo ""
echo "# 1. SSH ì ‘ì†"
echo "ssh docker@192.168.50.215 -p 1111"
echo ""
echo "# 2. í˜„ì¬ ì»¨í…Œì´ë„ˆ í™•ì¸"
echo "docker ps | grep blacklist"
echo ""
echo "# 3. ê¸°ì¡´ ì»¨í…Œì´ë„ˆë“¤ ì •ì§€ ë° ì œê±°"
echo "docker stop blacklist-app blacklist-redis"
echo "docker rm blacklist-app blacklist-redis"
echo ""
echo "# 4. ìµœì‹  ì´ë¯¸ì§€ í’€"
echo "docker pull registry.jclee.me/blacklist:latest"
echo ""
echo "# 5. ë‹¨ì¼ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ (ë©”ëª¨ë¦¬ ìºì‹œ ëª¨ë“œ)"
echo "docker run -d \\"
echo "  --name blacklist \\"
echo "  --restart unless-stopped \\"
echo "  -p 2541:2541 \\"
echo "  -v /opt/blacklist/instance:/app/instance \\"
echo "  -v /opt/blacklist/data:/app/data \\"
echo "  -v /opt/blacklist/logs:/app/logs \\"
echo "  -e FLASK_ENV=production \\"
echo "  -e PORT=2541 \\"
echo "  -e REGTECH_USERNAME=nextrade \\"
echo "  -e REGTECH_PASSWORD='Sprtmxm1@3' \\"
echo "  -e SECUDIUM_USERNAME=nextrade \\"
echo "  -e SECUDIUM_PASSWORD='Sprtmxm1@3' \\"
echo "  --label 'com.centurylinklabs.watchtower.enable=true' \\"
echo "  registry.jclee.me/blacklist:latest"
echo ""
echo "# 6. í—¬ìŠ¤ ì²´í¬"
echo "curl http://localhost:2541/health"
echo ""
echo "# 7. ìƒíƒœ í™•ì¸"
echo "docker ps"
echo "docker logs blacklist -f"
echo ""
echo "ë³€ê²½ ì‚¬í•­:"
echo "  - ì»¨í…Œì´ë„ˆ ìˆ˜: 2ê°œ â†’ 1ê°œ"
echo "  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ~200MB â†’ ~100MB"
echo "  - ìºì‹œ: Redis â†’ ë©”ëª¨ë¦¬"
echo "  - ê´€ë¦¬: ê°„ì†Œí™”"
echo ""
echo "ì°¸ê³ : Redis ë°ì´í„°ëŠ” ì£¼ë¡œ ìºì‹œìš©ì´ë¯€ë¡œ ì†ì‹¤ë˜ì–´ë„ ë¬¸ì œì—†ìŠµë‹ˆë‹¤."